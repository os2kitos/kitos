<!-- Project Roles -->
<div class="panel panel-default">
    <div class="panel-heading">
        <i class="glyphicon glyphicon-user"></i>
        Projektroller
    </div>
    <table class="full-width table org-role-table">
        <thead>
            <tr>
                <th>
                    <button class="btn btn-link btn-header" data-ng-click="projectRolesVm.rightSortChange('roleName')">Projektrolle</button></th>
                <th>
                    <button class="btn btn-link btn-header" data-ng-click="projectRolesVm.rightSortChange('userName')">Navn</button></th>
                <th>
                    <button class="btn btn-link btn-header" data-ng-click="projectRolesVm.rightSortChange('userEmail')">Email</button></th>
            </tr>
        </thead>
        <!-- for each right -->
        <tbody data-ng-repeat="right in projectRolesVm.rights | filter : { show: true } | orderBy : projectRolesVm.rightSort : projectRolesVm.rightSortReverse">
            <!-- show -->
            <tr data-ng-hide="right.edit">
                <td>{{ right.role.name }}</td>
                <td>{{ right.user.fullName }}</td>
                <td>
                    {{ right.user.email }}
                    <div data-ng-show="projectEditVm.hasWriteAccess" class="pull-right">
                        <a data-ng-click="right.edit = true" class="btn btn-info btn-xs">
                            <i class="glyphicon glyphicon-pencil"></i>
                        </a>
                        <a class="btn btn-danger btn-xs"
                           data-confirmed-click="projectRolesVm.deleteRight(right)"
                           data-confirm-click="Er du sikker på at du vil slette?">
                            <i class="glyphicon glyphicon-trash"></i>
                        </a>
                    </div>
                </td>
            </tr>

            <!-- edit -->
            <tr data-ng-show="right.edit">
                <td>
                    <select data-ui-select2="" name="selectRole" data-ng-model="right.roleForSelect" class="form-control input-sm">
                        <option data-ng-show="right.role.isActive == false" disabled="true" value="{{right.role.id}}">{{right.role.name}} {{ right.role.isActive == true ? "" : "(Inaktiv rolle)"}}</option>
                        <option data-ng-repeat="projectRole in projectRolesVm.activeItProjectRoles" value="{{projectRole.id}}">
                            {{projectRole.name}} ({{projectRole.hasWriteAccess && "skriv" || "læs" }})
                        </option>
                    </select>
                </td>
                <td colspan="2" class="relative-position">
                    <input data-select-user="foo" data-org-id="{{projectRolesVm.orgId}}" data-user-model="right.userForSelect" />
                    <div class="pull-outside-table">
                        <input type="submit" class="btn btn-success btn-sm" data-ng-click="projectRolesVm.updateRight(right)" value="Gem" />
                    </div>
                </td>
            </tr>
        </tbody>

        <!-- add-new-right row -->
        <tbody data-ng-hide="!projectEditVm.hasWriteAccess">
            <tr>
                <td>
                    <select data-ui-select2="" name="selectRole" data-ng-model="projectRolesVm.newRole" data-placeholder="Vælg en projektrolle" class="form-control input-sm" data-ng-change="projectRolesVm.submitRight()">
                        <option value=""></option>
                        <option data-ng-repeat="projectRole in projectRolesVm.activeItProjectRoles" value="{{projectRole.id}}">
                            {{projectRole.name}} ({{projectRole.hasWriteAccess && "skriv" || "læs" }})
                        </option>
                    </select>
                </td>
                <td colspan="2" class="form-group">
                    <input data-select-user="foo" data-org-id="{{projectRolesVm.orgId}}" data-user-model="projectRolesVm.selectedUser" />
                </td>
            </tr>
        </tbody>
    </table>
</div>
