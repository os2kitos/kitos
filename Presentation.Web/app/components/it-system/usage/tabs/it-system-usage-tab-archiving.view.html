<div class="object-section-container">
    <h4>{{usage.itSystem.name}} <span ng-if="usage.itSystem.disabled">(inaktiv)</span></h4>
    <div class="panel panel-default">
        <div class="row">
            <!-- 1st column -->
            <div class="col-xs-6">
                <!-- Archived -->
                <div class="form-group">
                    <label class="control-label small">Arkiveret</label><br>
                    <input type="radio" id="Archived"
                           data-ng-model="systemUsage.Archived"
                           ng-value="true"
                           data-ng-disabled="!hasWriteAccess"
                           ng-click="patch('Archived', true)"
                           data-field="Archived">
                    <label class="control-label small" for="Archived">Ja</label>

                    <input type="radio" id="Archived2"
                           data-ng-model="systemUsage.Archived"
                           ng-value="false"
                           data-ng-disabled="!hasWriteAccess || dirty"
                           ng-click="patch('Archived', false)"
                           data-field="Archived">
                    <label class="control-label small" for="Archived2">Nej</label>
                </div>
                <!-- ArchiveDuty -->
                <div class="form-group">
                    <label class="control-label small">Arkiveringspligt</label><br>
                    <input type="radio" id="ArchiveDutyB"
                           data-ng-model="systemUsage.ArchiveDuty"
                           ng-value="0"
                           data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                           ng-click="patch('ArchiveDuty', systemUsage.ArchiveDuty)"
                           data-field="ArchiveDuty">
                    <label class="control-label small" for="ArchiveDutyB">B</label>
                    <input type="radio" id="ArchiveDutyK"
                           data-ng-model="systemUsage.ArchiveDuty"
                           ng-value="1"
                           data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                           ng-click="patch('ArchiveDuty', systemUsage.ArchiveDuty)"
                           data-field="ArchiveDuty">
                    <label class="control-label small" for="ArchiveDutyK">K </label>
                    <input type="radio" id="ArchiveDutyDunno"
                           data-ng-model="systemUsage.ArchiveDuty"
                           ng-value="2"
                           data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                           ng-click="patch('ArchiveDuty', systemUsage.ArchiveDuty)"
                           data-field="ArchiveDuty">
                    <label class="control-label small" for="ArchiveDutyDunno">Ved ikke</label>
                </div>
                <!-- Archive duty -->
                <div class="form-group">
                    <label for="archiveDuty" class="control-label small">Arkiveringspligt</label>
                    <select class="form-control input-sm" id="archiveDuty"
                            ui-select2="{minimumResultsForSearch: -1}"
                            data-ng-model="usage.itSystem.archiveDuty"
                            data-autosave=""
                            data-field="ArchiveDuty"
                            data-ng-disabled="!hasWriteAccess || !systemUsage.Archived">
                        <option value="0">Ingen valgt</option>
                        <option value="1">B</option>
                        <option value="2">K</option>
                    </select>
                </div>
                <!-- ReportedToDPA -->
                <div class="form-group">
                    <label for="ReportedToDPA" class="control-label small">Anmeldt til datatilsynet</label><br>
                    <input type="radio" id="ReportedToDPA"
                           data-ng-model="systemUsage.ReportedToDPA"
                           ng-value="true"
                           data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                           ng-click="patch('ReportedToDPA', true)"
                           data-field="ReportedToDPA">
                    <label class="control-label small" for="ReportedToDPA">Ja</label>

                    <input type="radio" id="ReportedToDPA2"
                           data-ng-model="systemUsage.ReportedToDPA"
                           ng-value="false"
                           data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                           ng-click="patch('ReportedToDPA', false)"
                           data-field="ReportedToDPA">
                    <label class="control-label small" for="ReportedToDPA2">Nej</label>
                </div>
                <!-- DocketNo -->
                <div class="form-group">
                    <label for="DocketNo" class="control-label small">Journal-/Anmeldelsesnr</label>
                    <input type="text" id="DocketNo" class="form-control input-sm"
                           data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                           data-ng-model="systemUsage.DocketNo"
                           ng-blur="patch('DocketNo', systemUsage.DocketNo)"
                           data-field="DocketNo">
                </div>
            </div>
            <!-- 2nd column -->
            <div class="col-xs-6">
                <!-- ArchivedType -->
                <div class="form-group">
                    <select-option data-id="archive"
                                   data-label="Arkivtype"
                                   data-placeholder="Vælg arkivering"
                                   data-selected-text="{{ usage.archiveTypeName }}"
                                   ng-disabled="!systemUsage.Archived"
                                   data-ng-model="usage.archiveTypeId"
                                   data-options="archiveTypes"
                                   data-auto-save-url="api/itSystemUsage/{{usageId}}"
                                   data-field="archiveTypeId">
                    </select-option>
                    <!--<span class="help-block small">&nbsp;</span>-->
                </div>
                <!-- ArchiveLocation -->
                <div class="form-group">
                    <select-option data-id="archiveLocation"
                                   data-label="Arkiveringssted"
                                   data-placeholder="Vælg arkiveringssted"
                                   data-selected-text="{{ usage.archiveLocationName }}"
                                   data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                                   data-ng-model="usage.archiveLocationId"
                                   data-options="archiveLocations"
                                   data-auto-save-url="api/itSystemUsage/{{usageId}}"
                                   data-field="archiveLocationId">
                    </select-option>
                </div>
                <!-- Supplier -->
                <div class="form-group">
                    <label for="archiveSupplier" class="control-label small">Arkiveringsleverandører</label>
                    <input type="hidden" id="archiveSupplier" class="form-control input-sm"
                           data-ui-select2="suppliersSelectOptions"
                           data-ng-model="systemUsage.supplier"
                           ng-click="patchSupplier('SupplierId', systemUsage.supplier)"
                           data-field="SupplierId"
                           data-ng-disabled="!hasWriteAccess || !systemUsage.Archived">
                </div>
                <!-- ArchivedDate -->
                <!--<div class="form-group">
                    <label for="ArchivedDateId" class="control-label small">Arkiveringsdato</label>
                    <input type="text" id="ArchivedDateId" class="form-control"
                           data-kendo-date-picker
                           data-k-options="datepickerOptions"
                           data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                           data-ng-model="ArchivedDate"
                           ng-blur="patchDate('ArchivedDate', ArchivedDate)"
                           data-field="ArchivedDate">
                    <span id="helpBlock" class="help-block small">Eksempelvis "2017-04-25"</span>
                </div>-->
                <!-- ArchiveNotes -->
                <div class="form-group">
                    <label for="ArchiveNotes" class="control-label small">Arkiveringsbemærkninger</label>
                    <input type="text" id="ArchiveNotes" class="form-control input-sm"
                           data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                           data-ng-model="systemUsage.ArchiveNotes"
                           ng-blur="patch('ArchiveNotes', systemUsage.ArchiveNotes)"
                           data-field="ArchiveNotes">
                </div>
            </div>
        </div>
        <form role="form" name="archiveForm">
            <table class="table">
                <thead>
                    <tr>
                        <th class="col-xs-3">Startdato</th>
                        <th class="col-xs-3">Slutdato</th>
                        <th>Unikt arkiv-id</th>
                        <th><!-- control --></th>
                    </tr>
                </thead>
                <tbody>
                    <tr data-ng-repeat="archive in archivePeriods">
                        <td>
                            <input type="text" class="form-control"
                                   data-kendo-date-picker
                                   data-k-options="datepickerOptions"
                                   data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                                   data-ng-model="archive.StartDate"
                                   ng-change="patchDatePeriode('StartDate', archive.StartDate, archive.Id)"
                                   data-field="startDate">
                        </td>
                        <td>
                            <input type="text" class="form-control"
                                   data-kendo-date-picker
                                   data-k-options="datepickerOptions"
                                   data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                                   data-ng-model="archive.EndDate"
                                   ng-change="patchDatePeriode('EndDate', archive.EndDate, archive.Id)"
                                   data-field="endDate">
                        </td>
                        <td>
                            <div class="form-group">
                                <textarea class="form-control input-sm" style="resize:none" maxlength="20"
                                          data-ng-model="archive.UniqueArchiveId"
                                          ng-blur="patchPeriode('UniqueArchiveId', archive.UniqueArchiveId, archive.Id)"
                                          data-field="uniqueArchiveId"
                                          data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"></textarea>
                            </div>
                        </td>

                        <td>
                            <button class="btn btn-danger btn-sm delete-archive"
                                    data-confirmed-click="delete(archive.Id)"
                                    data-confirm-click="Er du sikker på at du vil slette?"
                                    data-ng-disabled="!hasWriteAccess || !systemUsage.Archived">
                                <span class="glyphicon glyphicon-trash small"></span>
                            </button>
                        </td>
                    </tr>
                </tbody>
                <tfoot data-ng-hide="!hasWriteAccess || !systemUsage.Archived">
                    <tr>
                        <td>
                            <div class="form-group" data-show-errors>
                                <input type="text"
                                       name="start"
                                       class="form-control"
                                       required
                                       data-kendo-date-picker
                                       data-k-options="datepickerOptions"
                                       data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                                       data-ng-model="archivePeriod.startDate">
                            </div>
                        </td>
                        <td>
                            <div class="form-group" data-show-errors>
                                <input type="text"
                                       name="end"
                                       class="form-control"
                                       required
                                       data-kendo-date-picker
                                       data-k-options="datepickerOptions"
                                       data-ng-disabled="!hasWriteAccess || !systemUsage.Archived"
                                       data-ng-model="archivePeriod.endDate">
                            </div>
                        </td>
                        <td>
                            <div class="form-group" data-show-errors>
                                <input type="text" name="uniqueArchiveId" class="form-control input-sm" data-ng-model="archivePeriod.uniqueArchiveId" style="resize: none" maxlength="20"/>
                            </div>
                        </td>
                        <td>
                            <button id="save-archive" class="btn btn-success btn-sm" data-ng-click="save()">Gem{{archivePeriod.startDate}}</button>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </form>
    </div>
</div>